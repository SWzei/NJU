import { ref } from "vue";

const STORAGE_KEY = "linquan_locale";
const SUPPORTED_LOCALES = ["zh", "en"];

const messages = {
  zh: {
    app: {
      clubName: "NJU林泉钢琴社",
      subtitle: "Created by SWzei",
      navHome: "首页",
      navSchedule: "琴时安排",
      navConcerts: "钢琴乐会",
      navMembers: "林泉相册",
      navProfile: "我的资料",
      navAdmin: "管理社团",
      navLogin: "登录",
      navRegister: "注册",
      navLogout: "退出",
      confirmLogout: "确认退出登录吗？",
      langZh: "中文",
      langEn: "English",
    },
    common: {
      title: "标题",
      content: "内容",
      status: "状态",
      time: "时间",
      location: "地点",
      room: "琴房",
      note: "备注",
      feedback: "反馈",
      name: "姓名",
      student: "学号",
      save: "保存",
      loading: "处理中...",
      choose: "请选择",
      noData: "暂无数据",
      show: "显示",
      hide: "隐藏",
    },
    day: {
      sun: "周日",
      mon: "周一",
      tue: "周二",
      wed: "周三",
      thu: "周四",
      fri: "周五",
      sat: "周六",
      sunShort: "周日",
      monShort: "周一",
      tueShort: "周二",
      wedShort: "周三",
      thuShort: "周四",
      friShort: "周五",
      satShort: "周六",
    },
    dashboard: {
      sloganTitle: "高林莺啭日正长，幽涧泉鸣夜未央",
      sloganBody: "可以进行每学期琴房安排、音乐会报名，以及社团活动信息查看。",
      heroPhotoAlt: "NJU林泉钢琴社首页主图",
      galleryTitle: "林泉影集",
      gallerySubtitle: "首页精选照片，可直接替换为社团真实照片。",
      galleryHint: "建议目录：public/photos/hero、club、events、concerts",
      photoRoom324Title: "琴房日常 A",
      photoRoom324Description: "大活 324 琴房的练习时段记录。",
      photoRoom324Alt: "324 琴房练习照片",
      photoRoom325Title: "琴房日常 B",
      photoRoom325Description: "大活 325 琴房的练习与交流。",
      photoRoom325Alt: "325 琴房练习照片",
      photoRehearsalTitle: "节目排练",
      photoRehearsalDescription: "音乐会前的分段排练与联排。",
      photoRehearsalAlt: "音乐会排练照片",
      photoWorkshopTitle: "主题活动",
      photoWorkshopDescription: "讲座、分享会与社团教学活动。",
      photoWorkshopAlt: "钢琴社活动照片",
      photoStageTitle: "舞台现场",
      photoStageDescription: "正式演出时的舞台氛围与灯光。",
      photoStageAlt: "钢琴演出舞台照片",
      photoGroupTitle: "社员合影",
      photoGroupDescription: "活动结束后的社员纪念合影。",
      photoGroupAlt: "社员合影照片",
      activityTitle: "社团活动",
      activitySubtitle: "近期活动与内部事项。",
      announcementTitle: "公告通知",
      announcementSubtitle: "管理员发布的重要通知。",
      adminTitle: "管理员版本",
      adminSubtitle: "你可以发布音乐会信息、确定琴时安排，并在需要时发布通知。",
      adminItemConcert: "发布音乐会信息与报名安排",
      adminItemSchedule: "审核并发布每学期琴房琴时安排",
      adminItemNotice: "向社员发布公告与临时通知",
      goAdmin: "进入管理后台",
      tbd: "待定",
      noActivities: "暂无活动信息。",
      noAnnouncements: "暂无公告。",
    },
    login: {
      title: "社员登录",
      subtitle: "使用学号或邮箱 + 密码登录。",
      credential: "学号或邮箱",
      password: "密码",
      credentialPlaceholder: "例如：240000000 或 example@nju.edu.cn",
      passwordPlaceholder: "请输入密码",
      loggingIn: "登录中...",
      login: "登录",
      noAccount: "还没有账号？",
      createAccount: "立即注册",
      failed: "登录失败。",
    },
    register: {
      title: "社员注册",
      subtitle: "学号必填；邮箱选填，建议填写以接收通知。",
      studentNumber: "学号 *",
      emailOptional: "邮箱",
      displayName: "姓名",
      password: "密码 *",
      studentNumberPlaceholder: "例如：202300000001",
      emailPlaceholder: "例如：example@nju.edu.cn",
      displayNamePlaceholder: "例如：张三",
      passwordPlaceholder: "至少 6 位",
      creating: "创建中...",
      register: "注册",
      hasAccount: "已有账号？",
      login: "去登录",
      failed: "注册失败。",
    },
    schedule: {
      title: "琴时时间提交",
      subtitle: "可选择任意数量时段。每个时段显示已选择该时段的人数。",
      headerTime: "时间",
      headerRoom1: "大活324琴房",
      headerRoom2: "大活325琴房",
      selectedCount: "已选 {count} 人",
      saving: "保存中...",
      save: "保存",
      selectedSlots: "已选 {count} 个时段",
      assignmentTitle: "已发布琴时安排",
      assignmentSubtitle: "管理员审核发布后，社员每周分配 1-2 小时。",
      noAssignment: "你的账号暂无已发布琴时安排。",
      saveSuccess: "已更新。",
      saveFailed: "保存失败。",
      confirmSave: "确认保存当前琴时志愿吗？",
      loadFailed: "琴时安排数据加载失败。",
    },
    concerts: {
      cycleTitle: "音乐会",
      cycleSubtitle: "公告、报名、审核安排与反馈。",
      statusLabel: "状态",
      deadline: "截止",
      noDetails: "暂无详细信息。",
      noConcerts: "暂无可查看的音乐会信息。",
      applyTitle: "报名申请",
      applySubtitle: "按规范提交报名信息与可选乐谱文件。",
      selectedConcert: "选择音乐会",
      pieceTitle: "曲目",
      composer: "曲目英文信息",
      note: "备注",
      applicantNamePlaceholder: "例如：张三",
      applicantStudentNumberPlaceholder: "例如：202300000001",
      pieceZh: "曲目作者与名称（中文）*",
      pieceZhPlaceholder: "例如：李斯特：b 小调奏鸣曲",
      pieceEn: "曲目作者与名称（英文）*",
      pieceEnPlaceholder: "例如：Lizst: Sonata in b minor, S.178",
      durationMin: "预计时长（min）*",
      contactQq: "联系方式（QQ）*",
      contactQqPlaceholder: "例如：123456789",
      pieceTitlePlaceholder: "例如：李斯特：b 小调奏鸣曲",
      composerPlaceholder: "例如：Lizst: Sonata in b minor, S.178",
      notePlaceholder: "例如：可参加 2026-01-02 晚上审核",
      scoreFile: "乐谱文件（pdf/图片）",
      submitting: "提交中...",
      submit: "提交申请",
      auditionTitle: "审核安排",
      performer: "演奏者",
      piece: "曲目",
      noAudition: "暂无审核安排。",
      resultTitle: "我的结果 / 反馈",
      resultFallback: "结果",
      noFeedback: "暂无反馈。",
      noResult: "暂无已发布结果。",
      chooseConcert: "请先选择音乐会。",
      submitSuccess: "报名提交成功。",
      submitFailed: "报名提交失败。",
      downloadAttachment: "下载音乐会附件",
      currentApplicationTitle: "我的已提交报名信息",
      currentApplicationHint: "你可以直接修改上方内容后再次提交。",
      downloadScoreFile: "下载已提交乐谱",
      noScoreFile: "未上传乐谱",
      confirmSubmit: "确认提交当前音乐会申请吗？",
      loadDetailsFailed: "音乐会详情加载失败。",
      loadFailed: "音乐会列表加载失败。",
    },
    concertStatus: {
      draft: "草稿",
      open: "报名中",
      audition: "审核中",
      result: "结果发布",
      closed: "已结束",
    },
    auditionResult: {
      submitted: "已提交",
      accepted: "通过",
      rejected: "未通过",
      waitlist: "候补",
    },
    profile: {
      title: "我的资料",
      displayName: "姓名",
      avatarUrl: "头像 URL",
      avatarUpload: "本地上传头像",
      avatarUploadHint: "选择本地图片后，点击“保存资料”即可上传并应用。",
      personalPhoto: "个人照片",
      personalPhotoPlaceholder: "请输入照片链接，例如：https://...",
      photoUpload: "本地上传个人照片",
      photoUploadHint: "可直接上传本地照片，系统会自动保存到个人资料。",
      bio: "个人简介",
      grade: "年级",
      gradePlaceholder: "例如：2024级本",
      academy: "院系",
      academyPlaceholder: "例如：计算机学院",
      major: "专业",
      majorPlaceholder: "例如：大气科学",
      hobbies: "兴趣爱好",
      hobbiesPlaceholder: "例如：摄影、定向越野、羽毛球",
      pianoInterests: "钢琴兴趣",
      pianoInterestsPlaceholder: "例如：爵士、肖邦",
      wechatAccount: "微信号",
      wechatPlaceholder: "例如：linquan_wechat",
      saving: "保存中...",
      save: "保存资料",
      directoryTitle: "社员目录",
      searchMember: "搜索社员",
      searchMemberPlaceholder: "输入姓名 / 学号 / 院系 / 专业",
      memberDetailTitle: "社员详情",
      backToDirectory: "返回社员目录",
      memberNotFound: "未找到该社员信息。",
      academyUnset: "院系未设置",
      majorUnset: "专业未设置",
      gradeUnset: "年级未设置",
      phone: "电话",
      phonePlaceholder: "例如：13800000000",
      notProvided: "暂未填写",
      noIntro: "暂无自我介绍。",
      noProfiles: "暂无社员资料。",
      saveSuccess: "资料已保存。",
      saveFailed: "资料保存失败。",
      confirmSave: "确认保存个人资料吗？",
      loadFailed: "资料加载失败。",
    },
    admin: {
      pagePublishing: "信息发布",
      pageScheduling: "琴时安排",
      pageConcerts: "音乐会管理",
      pageReviews: "审核管理",
      pageGallery: "相册展示",
      pageMembers: "成员账号",
      sectionPublish: "信息发布",
      sectionScheduling: "琴时安排",
      sectionConcert: "音乐会管理",
      sectionReview: "审核管理",
      manageGallery: "相册展示管理",
      gallerySubtitle: "控制 Members 页面林泉影集的展示内容与顺序。",
      galleryAdd: "新增展示项",
      galleryList: "已配置展示项",
      galleryEmpty: "暂无展示项。",
      gallerySource: "图片路径",
      gallerySourcePlaceholder: "例如：/photos/club/new-photo.jpg",
      galleryUpload: "本地上传图片",
      galleryUploadHint: "先上传本地图片，再保存展示项。",
      galleryUploadButton: "上传并填入路径",
      galleryReplaceButton: "上传并替换当前图片",
      galleryFileRequired: "请先选择图片文件。",
      galleryUploadSuccess: "图片上传成功。",
      galleryFallback: "备用图片 URL",
      galleryFallbackPlaceholder: "例如：https://example.com/fallback.jpg",
      galleryTitleZh: "中文标题",
      galleryTitleEn: "英文标题",
      galleryDescZh: "中文描述",
      galleryDescEn: "英文描述",
      galleryAltZh: "中文替代文本",
      galleryAltEn: "英文替代文本",
      galleryOrder: "显示顺序",
      galleryVisible: "显示该项",
      galleryCreateButton: "新增展示项",
      gallerySave: "保存展示项",
      galleryDelete: "删除展示项",
      publishActivity: "发布活动",
      publishAnnouncement: "发布公告",
      createSemester: "创建学期",
      semesterName: "学期名称",
      startDate: "开始日期",
      endDate: "结束日期",
      setActive: "设为当前学期",
      createSemesterButton: "创建学期并生成 2x7x14 时段",
      schedulingControl: "琴时安排控制",
      runSchedule: "生成草案排班",
      runScheduleWithWarning: "生成草案排班（注意：会清空当前草案生成）",
      runScheduleWarning: "注意：会清空当前草案并重新生成。",
      updateSchedule: "更新草案排班（保留已有安排并补全空闲）",
      refreshProposed: "刷新草案排班",
      publishBatchId: "发布编号（内部）",
      publishSchedule: "发布琴时安排并通知社员",
      downloadCalendar: "下载琴时安排日历",
      downloadPreferenceCsv: "下载原始志愿数据（CSV）",
      downloading: "下载中...",
      noProposedSchedule: "当前没有草案排班，请先生成。",
      draftScheduleReady: "当前已有草案排班，可继续手动调整。",
      noDraftSchedule: "当前尚无草案排班，请先生成。",
      noCurrentSemester: "当前无激活学期。",
      currentSemesterInfo: "当前学期：{name}（{start} 至 {end}）",
      calendarGuide:
        "点击已有分配的格子选择成员，再点击任意目标时段完成移动；若目标已占用将自动互换。",
      requirementCheckTitle: "排班要求检查",
      requirementOverall: "总体状态：{state}",
      requirementSatisfied: "满足",
      requirementUnsatisfied: "未满足",
      requirementFairness: "已满足人数 {achieved}/{target}",
      requirementHours: "超 2 小时：{over}",
      requirementUtilization: "时段利用率：{assigned}/{total}（{rate}）",
      memberSearch: "搜索社员",
      memberSearchPlaceholder: "输入姓名或学号",
      pickMemberToAssign: "先选择一位社员，再点击空闲时段直接分配。",
      assignedHours: "已分配 {count} 小时",
      noMemberMatch: "没有匹配到社员。",
      memberRequired: "请先选择要安排的社员。",
      selectedMember: "当前已选择社员：{name}",
      confirmAssignMember:
        "确认将 {name} 分配到 {day} {hour}:00 琴房{room} 吗？",
      slotOccupiedChooseIdle: "该时段已被占用，请选择空闲时段。",
      memberAssigned: "已成功分配该时段。",
      unassigned: "未分配",
      clickToMove: "点击可移动到此",
      selectedAssignment: "已选中：{name}（{day} {hour}:00 琴房{room}）",
      confirmMoveAssignment:
        "确认将该成员移动到 {day} {hour}:00 琴房{room} 吗？",
      assignmentMoved: "琴时安排已更新。",
      assignmentSwapped: "已完成互换并更新琴时安排。",
      deleteSelectedSlot: "删除当前选中琴时安排",
      slotDeleted: "琴时安排已删除。",
      undoOperation: "撤销上一步",
      redoOperation: "重做上一步",
      undoDone: "已撤销上一步操作。",
      redoDone: "已重做上一步操作。",
      operationHistory: "操作记录",
      opRunSchedule: "生成草案排班",
      opUpdateSchedule: "更新草案排班，新增 {count} 条分配",
      opManualAssign: "手动分配：社员 {userId} -> 时段 {slotId}",
      opMoveAssign: "移动分配：社员 {userId}，{from} -> {to}",
      opSwapAssign: "互换分配：社员 {source} <-> 社员 {target}",
      opDeleteAssign: "删除分配：社员 {userId} 从时段 {slotId}",
      opPublishSchedule: "发布排班",
      calendarExported: "琴时安排日历已下载。",
      calendarExportFailed: "琴时安排日历导出失败。",
      preferenceCsvExported: "原始志愿数据已下载。",
      preferenceCsvExportFailed: "原始志愿数据导出失败。",
      calendarPreviewTitle: "排班日历预览",
      calendarPreviewSubtitle:
        "可在网页中直接查看本学期每周时段分配情况（中文预览）。",
      proposedBatch: "草案排班 #{id} · 学期 {semesterId}",
      slotEditorTitle: "时段安排面板",
      slotEditorTarget: "{day} {hour}:00 · 琴房{room} · 志愿人数 {selected}",
      slotEditorOccupiedBy: "当前安排：{name}（{student}）",
      slotEditorMoveHint: "点击其他时段即可将该成员移动/互换到目标时段。",
      slotEditorMemberSearch: "搜索待安排社员",
      slotEditorChooseMember: "选择要安排的社员（显示 {shown}/{total}）",
      slotEditorAssign: "安排到该时段",
      slotEditorClickToArrange: "点击后可安排",
      slotEditorNarrowHint: "结果较多，请继续输入关键词缩小范围。",
      clearSelectedMember: "清除选择",
      clearMoveSelection: "取消移动选择",
      quickActionsTitle: "快捷操作",
      quickActionsShow: "显示快捷操作",
      quickActionsHide: "隐藏快捷操作",
      unsatisfiedListTitle: "未满足要求社员预览",
      assignedHoursShort: "已分配",
      preferenceCountShort: "志愿数",
      unsatisfiedReason: "未满足原因",
      unsatisfiedReasonNoAssignment: "未分配到时段",
      unsatisfiedReasonOverLimit: "超过每周 2 小时",
      unsatisfiedAllGood: "当前所有社员均满足排班基本要求。",
      assignmentId: "分配 ID",
      slot: "时段",
      showingFirst50: "仅显示前 50 条分配，可通过 API 查看/修改全部。",
      createConcert: "创建音乐会周期",
      manageConcerts: "管理已创建音乐会",
      noConcertsAdmin: "暂无音乐会记录。",
      editConcert: "编辑音乐会",
      description: "描述",
      announcement: "公告",
      applicationDeadline: "报名截止时间",
      attachmentFile: "附件文件",
      currentAttachment: "查看当前附件",
      removeAttachment: "移除当前附件",
      saveConcert: "保存音乐会信息",
      releaseConcert: "发布该音乐会并通知",
      releaseMessage: "发布通知内容（选填）",
      createConcertButton: "创建音乐会",
      reviewSlotTitle: "审核时段设置",
      reviewResultTitle: "审核结果发布",
      createAuditionSlot: "创建审核时段",
      concertSelect: "选择音乐会",
      applicationSelectOptional: "选择申请（可选）",
      applicationSelect: "选择申请",
      noSpecificApplication: "不指定申请",
      concertId: "音乐会 ID",
      applicationIdOptional: "申请 ID（选填）",
      applicationId: "申请 ID",
      registrationListTitle: "报名信息总览",
      registrationDetailTitle: "报名详情",
      loadRegistrations: "加载报名信息",
      downloadRegistrationsCsv: "下载报名数据（CSV）",
      noRegistrations: "暂无报名信息。",
      registrationCsvExported: "报名数据 CSV 已下载。",
      registrationCsvExportFailed: "报名数据 CSV 导出失败。",
      viewScoreFile: "查看乐谱",
      concertIdPlaceholder: "例如：1",
      applicationIdPlaceholder: "例如：12",
      dateTimePlaceholder: "例如：2026-01-02T18:30:00",
      locationPlaceholder: "例如：大活324",
      feedbackPlaceholder: "填写审核意见...",
      dateTimeGuide: "请选择精确到分钟的时间，系统会自动保存为标准格式。",
      start: "开始时间",
      end: "结束时间",
      addAuditionSlot: "添加审核时段",
      publishAuditionResult: "发布审核结果",
      publishResultButton: "发布结果并通知",
      eventTime: "活动时间",
      title: "标题",
      content: "内容",
      location: "地点",
      manageActivities: "管理活动",
      noActivitiesAdmin: "暂无活动信息。",
      editActivity: "编辑活动",
      saveActivity: "保存活动",
      deleteActivity: "删除活动",
      manageAnnouncements: "管理公告",
      noAnnouncementsAdmin: "暂无公告信息。",
      editAnnouncement: "编辑公告",
      saveAnnouncement: "保存公告",
      deleteAnnouncement: "删除公告",
      memberAccountMgmt: "成员账号管理",
      memberAccountSubtitle:
        "查看成员基本信息（含账号与密码哈希），并可重置密码或注销账号。",
      memberAccountSearch: "搜索成员",
      memberAccountSearchPlaceholder: "输入姓名 / 学号 / 邮箱 / 院系 / 专业",
      loadMembers: "加载成员",
      memberAccountEmpty: "暂无可管理的成员账号。",
      memberAccountDetail: "成员详情",
      memberDetailEmpty: "请先在左侧选择一位成员。",
      memberAccount: "账号",
      memberEmail: "邮箱",
      memberCreatedAt: "注册时间",
      memberPasswordHash: "密码（哈希）",
      memberResetPasswordInput: "新密码（可选）",
      memberResetPasswordPlaceholder:
        "留空则自动生成临时密码（建议至少 6 位）",
      memberResetPasswordHint:
        "系统不会存储明文密码。重置后仅在当前页面显示一次临时密码。",
      memberResetPassword: "重置密码",
      memberTemporaryPassword: "最新临时密码（请立即通知成员）：",
      memberDelete: "注销账号",
      memberDeleted: "成员账号已注销。",
      memberPasswordReset: "密码已重置，临时密码：{password}",
      memberLoadFailed: "成员账号数据加载失败。",
      statePublished: "已发布",
      stateUnpublished: "未发布",
      publishActivityButton: "发布活动",
      publishAnnouncementButton: "发布公告",
      errorRequest: "请求失败。",
      activityPublished: "活动已发布。",
      activityUpdated: "活动已更新。",
      activityDeleted: "活动已删除。",
      announcementPublished: "公告已发布。",
      announcementUpdated: "公告已更新。",
      announcementDeleted: "公告已删除。",
      galleryCreated: "展示项已新增。",
      galleryUpdated: "展示项已更新。",
      galleryDeleted: "展示项已删除。",
      galleryLoadFailed: "相册配置加载失败。",
      semesterCreated: "学期创建成功，ID：{id}。",
      scheduleGenerated: "草案排班已生成，编号：{id}。",
      scheduleDraftCreated: "草案排班已生成。",
      scheduleDraftUpdated: "草案排班已更新，新增 {count} 条分配。",
      batchRequired: "发布编号必填。",
      schedulePublished: "琴时安排已发布，已发送邮件：{count}。",
      concertCreated: "音乐会创建成功，ID：{id}。",
      concertUpdated: "音乐会信息已更新。",
      concertReleased: "音乐会已发布，通知发送：{count}。",
      auditionCreated: "审核时段已创建。",
      resultPublished: "结果已发布并加入通知队列。",
      confirmPublishActivity: "确认发布该活动吗？",
      confirmPublishAnnouncement: "确认发布该公告吗？",
      confirmSaveActivity: "确认保存该活动修改吗？",
      confirmDeleteActivity: "确认删除该活动吗？",
      confirmSaveAnnouncement: "确认保存该公告修改吗？",
      confirmDeleteAnnouncement: "确认删除该公告吗？",
      confirmCreateGallery: "确认新增该展示项吗？",
      confirmSaveGallery: "确认保存该展示项修改吗？",
      confirmDeleteGallery: "确认删除该展示项吗？",
      confirmCreateSemester: "确认创建该学期并生成时段吗？",
      confirmRunSchedule: "确认生成新的草案排班吗？该操作会清空当前草案排班。",
      confirmUpdateSchedule:
        "确认更新草案排班吗？系统将保留已有安排并补全可用空闲时段。",
      confirmPublishSchedule: "确认发布当前排班并通知社员吗？",
      confirmDeleteSelectedSlot: "确认删除当前选中琴时安排吗？",
      confirmResetMemberPassword: "确认重置该成员密码吗？",
      confirmDeleteMember: "确认注销该成员账号吗？该操作不可撤销。",
      confirmCreateConcert: "确认创建该音乐会周期吗？",
      confirmUpdateConcert: "确认保存该音乐会修改吗？",
      confirmReleaseConcert: "确认发布该音乐会并发送通知吗？",
      confirmCreateReviewSlot: "确认创建该审核时段吗？",
      confirmPublishReviewResult: "确认发布该审核结果吗？",
      concertRequired: "请先选择音乐会。",
      applicationRequired: "请先选择申请。",
    },
  },
  en: {
    app: {
      clubName: "NJU林泉钢琴社",
      subtitle: "Created by SWzei",
      navHome: "Home",
      navSchedule: "Piano Time",
      navConcerts: "Concerts",
      navMembers: "Members",
      navProfile: "My Profile",
      navAdmin: "Admin",
      navLogin: "Login",
      navRegister: "Register",
      navLogout: "Logout",
      confirmLogout: "Log out now?",
      langZh: "中文",
      langEn: "English",
    },
    common: {
      title: "Title",
      content: "Content",
      status: "Status",
      time: "Time",
      location: "Location",
      room: "Room",
      note: "Note",
      feedback: "Feedback",
      name: "Name",
      student: "Student",
      save: "Save",
      loading: "Loading...",
      choose: "Please choose",
      noData: "No data",
      show: "Show",
      hide: "Hide",
    },
    day: {
      sun: "Sunday",
      mon: "Monday",
      tue: "Tuesday",
      wed: "Wednesday",
      thu: "Thursday",
      fri: "Friday",
      sat: "Saturday",
      sunShort: "Sun",
      monShort: "Mon",
      tueShort: "Tue",
      wedShort: "Wed",
      thuShort: "Thu",
      friShort: "Fri",
      satShort: "Sat",
    },
    dashboard: {
      sloganTitle:
        "Orioles sing in high woods by day, springs flow through deep ravines at night.",
      sloganBody:
        "Manage semester piano time scheduling, concert applications, and club updates.",
      heroPhotoAlt: "NJU Linquan Piano Club homepage hero photo",
      galleryTitle: "Linquan Gallery",
      gallerySubtitle:
        "Featured photos on the homepage. Replace them with your real club photos directly.",
      galleryHint:
        "Recommended folders: public/photos/hero, club, events, concerts",
      photoRoom324Title: "Practice Room A",
      photoRoom324Description: "Daily practice snapshots from Room 324.",
      photoRoom324Alt: "Practice photo in Room 324",
      photoRoom325Title: "Practice Room B",
      photoRoom325Description: "Practice and communication in Room 325.",
      photoRoom325Alt: "Practice photo in Room 325",
      photoRehearsalTitle: "Concert Rehearsal",
      photoRehearsalDescription:
        "Section rehearsal and full run before performances.",
      photoRehearsalAlt: "Concert rehearsal photo",
      photoWorkshopTitle: "Club Workshop",
      photoWorkshopDescription:
        "Lectures, sharing sessions, and training activities.",
      photoWorkshopAlt: "Piano club workshop photo",
      photoStageTitle: "On Stage",
      photoStageDescription: "Stage atmosphere and performance lighting.",
      photoStageAlt: "Piano stage performance photo",
      photoGroupTitle: "Group Photo",
      photoGroupDescription: "Member group photo after event completion.",
      photoGroupAlt: "Club member group photo",
      activityTitle: "Club Activities",
      activitySubtitle: "Recent events and internal activities.",
      announcementTitle: "Announcements",
      announcementSubtitle: "Important notices from administrators.",
      adminTitle: "Administrator Version",
      adminSubtitle:
        "You can publish concert info, settle piano time arrangements, and send notices when needed.",
      adminItemConcert: "Publish concert information and application details",
      adminItemSchedule: "Review and release semester piano-time scheduling",
      adminItemNotice: "Send announcements and urgent notices to members",
      goAdmin: "Open Admin Panel",
      tbd: "TBD",
      noActivities: "No activity posts yet.",
      noAnnouncements: "No announcements yet.",
    },
    login: {
      title: "Member Login",
      subtitle: "Use student number or email with password.",
      credential: "Student Number or Email",
      password: "Password",
      credentialPlaceholder: "e.g. 202300000001 or example@nju.edu.cn",
      passwordPlaceholder: "Enter your password",
      loggingIn: "Signing In...",
      login: "Login",
      noAccount: "New member?",
      createAccount: "Create account",
      failed: "Login failed.",
    },
    register: {
      title: "Member Registration",
      subtitle:
        "Student number is required. Email is optional but recommended.",
      studentNumber: "Student Number *",
      emailOptional: "Email (optional)",
      displayName: "Full Name",
      password: "Password *",
      studentNumberPlaceholder: "e.g. 202300000001",
      emailPlaceholder: "e.g. example@nju.edu.cn",
      displayNamePlaceholder: "e.g. Zhang San",
      passwordPlaceholder: "At least 6 characters",
      creating: "Creating...",
      register: "Register",
      hasAccount: "Already registered?",
      login: "Login",
      failed: "Registration failed.",
    },
    schedule: {
      title: "Piano Time Submission",
      subtitle:
        "Select any number of weekly slots. Each slot shows current selection count.",
      headerTime: "Time",
      headerRoom1: "Student Center Room 324",
      headerRoom2: "Student Center Room 325",
      selectedCount: "{count} selected",
      saving: "Saving...",
      save: "Save",
      selectedSlots: "{count} slots selected",
      assignmentTitle: "Published Assignment",
      assignmentSubtitle:
        "Members are assigned 1-2 hours/week after admin review and release.",
      noAssignment: "No published schedule for your account yet.",
      saveSuccess: "Updated.",
      saveFailed: "Save failed.",
      confirmSave: "Save current piano-time preferences?",
      loadFailed: "Failed to load scheduling data.",
    },
    concerts: {
      cycleTitle: "Concerts",
      cycleSubtitle:
        "Announcements, registration, review scheduling, and feedback.",
      statusLabel: "Status",
      deadline: "Deadline",
      noDetails: "No details yet.",
      noConcerts: "No active concert info yet.",
      applyTitle: "Application Form",
      applySubtitle:
        "Submit required registration fields and an optional score file.",
      selectedConcert: "Choose Concert",
      pieceTitle: "Piece",
      composer: "Piece (English)",
      note: "Note",
      applicantNamePlaceholder: "e.g. Alice",
      applicantStudentNumberPlaceholder: "e.g. 202300000001",
      pieceZh: "Composer + Piece (Chinese) *",
      pieceZhPlaceholder: "e.g. Liszt: Sonata in B minor",
      pieceEn: "Composer + Piece (English) *",
      pieceEnPlaceholder: "e.g. Liszt: Sonata in B minor, S.178",
      durationMin: "Estimated Duration (min) *",
      contactQq: "Contact (QQ) *",
      contactQqPlaceholder: "e.g. 123456789",
      pieceTitlePlaceholder: "e.g. Liszt: Sonata in B minor",
      composerPlaceholder: "e.g. Liszt: Sonata in B minor, S.178",
      notePlaceholder: "e.g. Available for review on 2026-01-02 evening",
      scoreFile: "Score File (PDF/image)",
      submitting: "Submitting...",
      submit: "Submit Application",
      auditionTitle: "Review Schedule",
      performer: "Performer",
      piece: "Piece",
      noAudition: "No review schedule has been published.",
      resultTitle: "My Result / Feedback",
      resultFallback: "Result",
      noFeedback: "No feedback yet.",
      noResult: "No result published yet.",
      chooseConcert: "Please choose a concert.",
      submitSuccess: "Application submitted.",
      submitFailed: "Failed to submit application.",
      downloadAttachment: "Download concert attachment",
      currentApplicationTitle: "My Submitted Application",
      currentApplicationHint: "You can update the form above and submit again.",
      downloadScoreFile: "Download submitted score",
      noScoreFile: "No score file uploaded",
      confirmSubmit: "Submit this concert application now?",
      loadDetailsFailed: "Failed to load concert details.",
      loadFailed: "Failed to load concerts.",
    },
    concertStatus: {
      draft: "Draft",
      open: "Open",
      audition: "Review",
      result: "Result",
      closed: "Closed",
    },
    auditionResult: {
      submitted: "Submitted",
      accepted: "Accepted",
      rejected: "Rejected",
      waitlist: "Waitlist",
    },
    profile: {
      title: "My Profile",
      displayName: "Full Name",
      avatarUrl: "Avatar URL",
      avatarUpload: "Upload Local Avatar",
      avatarUploadHint:
        'Choose an image and click "Save Profile" to upload and apply it.',
      personalPhoto: "Personal Photograph",
      personalPhotoPlaceholder: "Enter image URL, e.g. https://...",
      photoUpload: "Upload Local Personal Photo",
      photoUploadHint:
        "Upload a local photo directly and it will be saved to your profile automatically.",
      bio: "Bio",
      grade: "Grade",
      gradePlaceholder: "e.g. Undergraduate Class of 2024",
      academy: "School/College",
      academyPlaceholder: "e.g. School of Computer Science",
      major: "Major",
      majorPlaceholder: "e.g. Atmospheric Science",
      hobbies: "Hobbies",
      hobbiesPlaceholder: "e.g. Photography, orienteering, badminton",
      pianoInterests: "Piano Interests",
      pianoInterestsPlaceholder: "e.g. Jazz, Chopin",
      wechatAccount: "WeChat Account",
      wechatPlaceholder: "e.g. linquan_wechat",
      saving: "Saving...",
      save: "Save Profile",
      directoryTitle: "Member Directory",
      searchMember: "Search Members",
      searchMemberPlaceholder: "Type name / student number / academy / major",
      memberDetailTitle: "Member Detail",
      backToDirectory: "Back to Member Directory",
      memberNotFound: "Member not found.",
      academyUnset: "Academy not set",
      majorUnset: "Major not set",
      gradeUnset: "Grade not set",
      phone: "Phone",
      phonePlaceholder: "e.g. +86 13800000000",
      notProvided: "Not provided",
      noIntro: "No self-introduction yet.",
      noProfiles: "No member profiles available.",
      saveSuccess: "Profile saved.",
      saveFailed: "Failed to save profile.",
      confirmSave: "Save profile changes now?",
      loadFailed: "Failed to load profile data.",
    },
    admin: {
      pagePublishing: "Publishing",
      pageScheduling: "Scheduling",
      pageConcerts: "Concert Management",
      pageReviews: "Review Management",
      pageGallery: "Gallery Display",
      pageMembers: "Member Accounts",
      sectionPublish: "Publishing",
      sectionScheduling: "Scheduling",
      sectionConcert: "Concert Management",
      sectionReview: "Review Management",
      manageGallery: "Gallery Display Management",
      gallerySubtitle:
        "Control visible cards and display order in the Members gallery.",
      galleryAdd: "Add Gallery Item",
      galleryList: "Configured Items",
      galleryEmpty: "No gallery items configured.",
      gallerySource: "Image Path",
      gallerySourcePlaceholder: "e.g. /photos/club/new-photo.jpg",
      galleryUpload: "Upload Local Image",
      galleryUploadHint:
        "Upload a local image first, then save the gallery item.",
      galleryUploadButton: "Upload and Fill Path",
      galleryReplaceButton: "Upload and Replace Current Image",
      galleryFileRequired: "Please choose an image file first.",
      galleryUploadSuccess: "Image uploaded successfully.",
      galleryFallback: "Fallback Image URL",
      galleryFallbackPlaceholder: "e.g. https://example.com/fallback.jpg",
      galleryTitleZh: "Chinese Title",
      galleryTitleEn: "English Title",
      galleryDescZh: "Chinese Description",
      galleryDescEn: "English Description",
      galleryAltZh: "Chinese Alt Text",
      galleryAltEn: "English Alt Text",
      galleryOrder: "Display Order",
      galleryVisible: "Visible",
      galleryCreateButton: "Create Gallery Item",
      gallerySave: "Save Item",
      galleryDelete: "Delete Item",
      publishActivity: "Publish Activity",
      publishAnnouncement: "Publish Announcement",
      createSemester: "Create Semester",
      semesterName: "Name",
      startDate: "Start Date",
      endDate: "End Date",
      setActive: "Set as active semester",
      createSemesterButton: "Create Semester with 2x7x14 Slots",
      schedulingControl: "Scheduling Control",
      runSchedule: "Generate Draft Schedule",
      runScheduleWithWarning:
        "Generate Draft Schedule (Warning: clears current draft and regenerates)",
      runScheduleWarning:
        "Warning: this will clear the current draft and regenerate.",
      updateSchedule: "Update Draft Schedule (keep current + fill idle slots)",
      refreshProposed: "Refresh Draft Schedule",
      publishBatchId: "Publish ID (Internal)",
      publishSchedule: "Publish Schedule + Notify Members",
      downloadCalendar: "Download Calendar",
      downloadPreferenceCsv: "Download Raw Preference CSV",
      downloading: "Downloading...",
      noProposedSchedule: "No draft schedule yet. Generate one first.",
      draftScheduleReady:
        "Draft schedule is ready for further manual adjustment.",
      noDraftSchedule: "No draft schedule yet.",
      noCurrentSemester: "No active semester currently.",
      currentSemesterInfo: "Current semester: {name} ({start} to {end})",
      calendarGuide:
        "Click an assigned slot to select a member, then click any target slot to move. Occupied targets will swap automatically.",
      requirementCheckTitle: "Requirement Check",
      requirementOverall: "Overall: {state}",
      requirementSatisfied: "Satisfied",
      requirementUnsatisfied: "Not satisfied",
      requirementFairness: "Satisfied members {achieved}/{target}",
      requirementHours: "Over 2 hours: {over}",
      requirementUtilization: "Utilization: {assigned}/{total} ({rate})",
      memberSearch: "Search Members",
      memberSearchPlaceholder: "Type name or student number",
      pickMemberToAssign:
        "Pick one member, then click an idle slot to assign directly.",
      assignedHours: "{count} hour(s) assigned",
      noMemberMatch: "No members match the search keyword.",
      memberRequired: "Please choose a member first.",
      selectedMember: "Selected member: {name}",
      confirmAssignMember: "Assign {name} to {day} {hour}:00 Room {room}?",
      slotOccupiedChooseIdle:
        "This slot is occupied. Please choose an idle slot.",
      memberAssigned: "Slot assigned successfully.",
      unassigned: "Unassigned",
      clickToMove: "Click to move here",
      selectedAssignment: "Selected: {name} ({day} {hour}:00 Room {room})",
      confirmMoveAssignment: "Move this member to {day} {hour}:00 Room {room}?",
      assignmentMoved: "Schedule updated.",
      assignmentSwapped: "Schedule swapped and updated.",
      deleteSelectedSlot: "Delete Selected Assignment",
      slotDeleted: "Assignment deleted.",
      undoOperation: "Undo Last Step",
      redoOperation: "Redo Last Step",
      undoDone: "Last operation undone.",
      redoDone: "Last operation redone.",
      operationHistory: "Operation History",
      opRunSchedule: "Generated draft schedule",
      opUpdateSchedule: "Updated draft schedule, added {count} assignment(s)",
      opManualAssign: "Manual assignment: member {userId} -> slot {slotId}",
      opMoveAssign: "Moved assignment: member {userId}, {from} -> {to}",
      opSwapAssign: "Swapped assignments: member {source} <-> member {target}",
      opDeleteAssign: "Deleted assignment: member {userId} from slot {slotId}",
      opPublishSchedule: "Published schedule",
      calendarExported: "Schedule calendar downloaded.",
      calendarExportFailed: "Failed to export schedule calendar.",
      preferenceCsvExported: "Raw preference CSV downloaded.",
      preferenceCsvExportFailed: "Failed to export raw preference CSV.",
      calendarPreviewTitle: "Schedule Calendar Preview",
      calendarPreviewSubtitle:
        "Preview weekly assignments directly on the page (shown with Chinese labels by default).",
      proposedBatch: "Draft Schedule #{id} · Semester {semesterId}",
      slotEditorTitle: "Slot Editor",
      slotEditorTarget:
        "{day} {hour}:00 · Room {room} · Preferences {selected}",
      slotEditorOccupiedBy: "Current assignment: {name} ({student})",
      slotEditorMoveHint: "Click another slot to move/swap this member.",
      slotEditorMemberSearch: "Search members to assign",
      slotEditorChooseMember: "Choose member (showing {shown}/{total})",
      slotEditorAssign: "Assign to this slot",
      slotEditorClickToArrange: "Click to arrange",
      slotEditorNarrowHint:
        "Too many results. Add more keywords to narrow down.",
      clearSelectedMember: "Clear Selection",
      clearMoveSelection: "Clear Move Selection",
      quickActionsTitle: "Quick Actions",
      quickActionsShow: "Show Quick Actions",
      quickActionsHide: "Hide Quick Actions",
      unsatisfiedListTitle: "Unsatisfied Members Preview",
      assignedHoursShort: "Assigned",
      preferenceCountShort: "Prefs",
      unsatisfiedReason: "Reason",
      unsatisfiedReasonNoAssignment: "No assigned slot",
      unsatisfiedReasonOverLimit: "More than 2 hours/week",
      unsatisfiedAllGood:
        "All members currently satisfy the basic scheduling requirements.",
      assignmentId: "Assignment ID",
      slot: "Slot",
      showingFirst50:
        "Showing first 50 assignments. Use API for full list or manual edits.",
      createConcert: "Create Concert Cycle",
      manageConcerts: "Manage Concerts",
      noConcertsAdmin: "No concerts created yet.",
      editConcert: "Edit Concert",
      description: "Description",
      announcement: "Announcement",
      applicationDeadline: "Application Deadline",
      attachmentFile: "Attachment File",
      currentAttachment: "View current attachment",
      removeAttachment: "Remove current attachment",
      saveConcert: "Save Concert",
      releaseConcert: "Release Concert + Notify",
      releaseMessage: "Release message (optional)",
      createConcertButton: "Create Concert",
      reviewSlotTitle: "Review Slot Setup",
      reviewResultTitle: "Review Result Publishing",
      createAuditionSlot: "Create Review Slot",
      concertSelect: "Select Concert",
      applicationSelectOptional: "Select Application (optional)",
      applicationSelect: "Select Application",
      noSpecificApplication: "No specific application",
      concertId: "Concert ID",
      applicationIdOptional: "Application ID (optional)",
      applicationId: "Application ID",
      registrationListTitle: "Registration Overview",
      registrationDetailTitle: "Registration Detail",
      loadRegistrations: "Load Registrations",
      downloadRegistrationsCsv: "Download Application CSV",
      noRegistrations: "No registrations yet.",
      registrationCsvExported: "Application CSV downloaded.",
      registrationCsvExportFailed: "Failed to export application CSV.",
      viewScoreFile: "View score",
      concertIdPlaceholder: "e.g. 1",
      applicationIdPlaceholder: "e.g. 12",
      dateTimePlaceholder: "e.g. 2026-01-02T18:30:00",
      locationPlaceholder: "e.g. Student Center Room 324",
      feedbackPlaceholder: "Write review feedback...",
      dateTimeGuide:
        "Pick precise date and time to the minute; it will be saved in standard format.",
      start: "Start",
      end: "End",
      addAuditionSlot: "Add Review Slot",
      publishAuditionResult: "Publish Review Result",
      publishResultButton: "Publish Result + Notify",
      eventTime: "Event Time",
      title: "Title",
      content: "Content",
      location: "Location",
      manageActivities: "Manage Activities",
      noActivitiesAdmin: "No activities available.",
      editActivity: "Edit Activity",
      saveActivity: "Save Activity",
      deleteActivity: "Delete Activity",
      manageAnnouncements: "Manage Announcements",
      noAnnouncementsAdmin: "No announcements available.",
      editAnnouncement: "Edit Announcement",
      saveAnnouncement: "Save Announcement",
      deleteAnnouncement: "Delete Announcement",
      memberAccountMgmt: "Member Account Management",
      memberAccountSubtitle:
        "View basic member info (including account and password hash), reset passwords, and deactivate accounts.",
      memberAccountSearch: "Search Members",
      memberAccountSearchPlaceholder:
        "Type name / student number / email / academy / major",
      loadMembers: "Load Members",
      memberAccountEmpty: "No member accounts found.",
      memberAccountDetail: "Member Details",
      memberDetailEmpty: "Select a member from the left list first.",
      memberAccount: "Account",
      memberEmail: "Email",
      memberCreatedAt: "Registered At",
      memberPasswordHash: "Password (Hash)",
      memberResetPasswordInput: "New Password (Optional)",
      memberResetPasswordPlaceholder:
        "Leave empty to auto-generate a temporary password (>= 6 chars)",
      memberResetPasswordHint:
        "Plaintext passwords are never stored. The temporary password is shown only once here.",
      memberResetPassword: "Reset Password",
      memberTemporaryPassword: "Latest temporary password (notify member now):",
      memberDelete: "Deactivate Account",
      memberDeleted: "Member account deactivated.",
      memberPasswordReset: "Password reset. Temporary password: {password}",
      memberLoadFailed: "Failed to load member account data.",
      statePublished: "Published",
      stateUnpublished: "Unpublished",
      publishActivityButton: "Publish Activity",
      publishAnnouncementButton: "Publish Announcement",
      errorRequest: "Request failed.",
      activityPublished: "Activity published.",
      activityUpdated: "Activity updated.",
      activityDeleted: "Activity deleted.",
      announcementPublished: "Announcement published.",
      announcementUpdated: "Announcement updated.",
      announcementDeleted: "Announcement deleted.",
      galleryCreated: "Gallery item created.",
      galleryUpdated: "Gallery item updated.",
      galleryDeleted: "Gallery item deleted.",
      galleryLoadFailed: "Failed to load gallery settings.",
      semesterCreated: "Semester created with ID {id}.",
      scheduleGenerated: "Draft schedule generated. ID {id}.",
      scheduleDraftCreated: "Draft schedule generated.",
      scheduleDraftUpdated:
        "Draft schedule updated, {count} new assignment(s) added.",
      batchRequired: "Publish ID is required.",
      schedulePublished: "Schedule published. {count} emails sent.",
      concertCreated: "Concert created with ID {id}.",
      concertUpdated: "Concert updated.",
      concertReleased: "Concert released. Notifications sent: {count}.",
      auditionCreated: "Review slot created.",
      resultPublished: "Result published and notification queued.",
      confirmPublishActivity: "Publish this activity now?",
      confirmPublishAnnouncement: "Publish this announcement now?",
      confirmSaveActivity: "Save changes to this activity now?",
      confirmDeleteActivity: "Delete this activity now?",
      confirmSaveAnnouncement: "Save changes to this announcement now?",
      confirmDeleteAnnouncement: "Delete this announcement now?",
      confirmCreateGallery: "Create this gallery item now?",
      confirmSaveGallery: "Save changes to this gallery item now?",
      confirmDeleteGallery: "Delete this gallery item now?",
      confirmCreateSemester: "Create this semester and generate all slots now?",
      confirmRunSchedule:
        "Generate a new draft schedule now? This will clear the current draft schedule.",
      confirmUpdateSchedule:
        "Update draft schedule now? Existing assignments will be kept and idle slots will be filled when possible.",
      confirmPublishSchedule:
        "Publish the current schedule and notify members now?",
      confirmDeleteSelectedSlot: "Delete the selected assignment now?",
      confirmResetMemberPassword: "Reset this member password now?",
      confirmDeleteMember:
        "Deactivate this member account now? This action cannot be undone.",
      confirmCreateConcert: "Create this concert cycle now?",
      confirmUpdateConcert: "Save changes to this concert now?",
      confirmReleaseConcert: "Release this concert and notify members now?",
      confirmCreateReviewSlot: "Create this review slot now?",
      confirmPublishReviewResult: "Publish this review result now?",
      concertRequired: "Please choose a concert first.",
      applicationRequired: "Please choose an application first.",
    },
  },
};

function getMessage(localeCode, key) {
  const parts = key.split(".");
  let current = messages[localeCode];
  for (const part of parts) {
    if (!current || typeof current !== "object") {
      return null;
    }
    current = current[part];
  }
  return typeof current === "string" ? current : null;
}

function formatMessage(template, params = {}) {
  return template.replace(/\{(\w+)\}/g, (match, name) => {
    if (Object.prototype.hasOwnProperty.call(params, name)) {
      return String(params[name]);
    }
    return match;
  });
}

const isBrowser = typeof window !== "undefined";
const storedLocale = isBrowser
  ? window.localStorage.getItem(STORAGE_KEY)
  : null;
const locale = ref(
  SUPPORTED_LOCALES.includes(storedLocale) ? storedLocale : "zh"
);

function applyLocaleToDocument(nextLocale) {
  if (!isBrowser) {
    return;
  }
  document.documentElement.lang = nextLocale === "zh" ? "zh-CN" : "en";
  document.title = getMessage(nextLocale, "app.clubName") || "NJU林泉钢琴社";
}

applyLocaleToDocument(locale.value);

export function setLocale(nextLocale) {
  if (!SUPPORTED_LOCALES.includes(nextLocale)) {
    return;
  }
  locale.value = nextLocale;
  if (isBrowser) {
    window.localStorage.setItem(STORAGE_KEY, nextLocale);
  }
  applyLocaleToDocument(nextLocale);
}

export function useI18n() {
  function t(key, params = {}) {
    const current =
      getMessage(locale.value, key) || getMessage("zh", key) || key;
    return formatMessage(current, params);
  }

  return {
    locale,
    t,
    setLocale,
    supportedLocales: SUPPORTED_LOCALES,
  };
}
